import{useCallback as n,useRef as e,useState as t,useEffect as r,useLayoutEffect as i}from"react";import o from"resize-observer-polyfill";function c(){return(c=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n}).apply(this,arguments)}var f="undefined"!=typeof window&&window.document&&window.document.createElement?i:r;export default function(i){var u=void 0===i?{}:i,a=u.maxFontSize,l=void 0===a?100:a,z=u.minFontSize,S=void 0===z?20:z,v=u.onFinish,d=u.onStart,s=u.resolution,m=void 0===s?5:s,w=n(function(){return{calcKey:0,fontSize:l,fontSizePrev:S,fontSizeMax:l,fontSizeMin:S}},[l,S]),M=e(null),h=e(),y=e(!1),p=t(w),x=p[0],K=p[1],b=x.calcKey,F=x.fontSize,P=x.fontSizeMax,g=x.fontSizeMin,H=x.fontSizePrev,O=null,j=t(function(){return new o(function(){O=window.requestAnimationFrame(function(){y.current||(d&&d(),y.current=!0,K(c({},w(),{calcKey:b+1})))})})})[0];r(function(){return M.current&&j.observe(M.current),function(){O&&window.cancelAnimationFrame(O),j.disconnect()}},[O,j]);var A=M.current&&M.current.innerHTML;return r(function(){0===b||y.current||(A!==h.current&&(d&&d(),K(c({},w(),{calcKey:b+1}))),h.current=A)},[b,w,A,d]),f(function(){if(0!==b){var n=Math.abs(F-H)<=m,e=!!M.current&&(M.current.scrollHeight>M.current.offsetHeight||M.current.scrollWidth>M.current.offsetWidth),t=F>H;if(n)e?K({fontSize:H<F?H:F-(H-F),fontSizeMax:P,fontSizeMin:g,fontSizePrev:H,calcKey:b}):(y.current=!1,v&&v(F));else{var r,i=P,o=g;e?(r=t?H-F:g-F,i=Math.min(P,F)):(r=t?P-F:H-F,o=Math.max(g,F)),K({calcKey:b,fontSize:F+r/2,fontSizeMax:i,fontSizeMin:o,fontSizePrev:F})}}},[b,F,P,g,H,v,M,m]),{fontSize:F+"%",ref:M}}
//# sourceMappingURL=index.esm.js.map
