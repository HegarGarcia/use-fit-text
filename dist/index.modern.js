import{useCallback as e,useRef as n,useState as t,useEffect as r,useLayoutEffect as o}from"react";import i from"resize-observer-polyfill";const c="undefined"!=typeof window&&window.document&&window.document.createElement?o:r;export default({maxFontSize:o=100,minFontSize:f=20,onFinish:u,onStart:a,resolution:l=5}={})=>{const z=e(()=>({calcKey:0,fontSize:o,fontSizePrev:f,fontSizeMax:o,fontSizeMin:f}),[o,f]),S=n(null),s=n(),m=n(!1),[d,M]=t(z),{calcKey:w,fontSize:h,fontSizeMax:y,fontSizeMin:v,fontSizePrev:x}=d;let K=null;const[p]=t(()=>new i(()=>{K=window.requestAnimationFrame(()=>{m.current||(a&&a(),m.current=!0,M({...z(),calcKey:w+1}))})}));r(()=>(S.current&&p.observe(S.current),()=>{K&&window.cancelAnimationFrame(K),p.disconnect()}),[K,p]);const F=S.current&&S.current.innerHTML;return r(()=>{0===w||m.current||(F!==s.current&&(a&&a(),M({...z(),calcKey:w+1})),s.current=F)},[w,z,F,a]),c(()=>{if(0===w)return;const e=Math.abs(h-x)<=l,n=!!S.current&&(S.current.scrollHeight>S.current.offsetHeight||S.current.scrollWidth>S.current.offsetWidth),t=h>x;if(e)return void(n?M({fontSize:x<h?x:h-(x-h),fontSizeMax:y,fontSizeMin:v,fontSizePrev:x,calcKey:w}):(m.current=!1,u&&u(h)));let r,o=y,i=v;n?(r=t?x-h:v-h,o=Math.min(y,h)):(r=t?y-h:x-h,i=Math.max(v,h)),M({calcKey:w,fontSize:h+r/2,fontSizeMax:o,fontSizeMin:i,fontSizePrev:h})},[w,h,y,v,x,u,S,l]),{fontSize:h+"%",ref:S}};
//# sourceMappingURL=index.modern.js.map
